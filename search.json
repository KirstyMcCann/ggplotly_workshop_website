[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "https://r-ladiesmelbourne.github.io/\n\n\n\n\nThis site provides a useful tutorial on how to use ggplot2, plotly, ggplotly and various visualisation forms for several use cases.\nIt provides useful links to established R manuals and helpful code.\nThe tutorial was part of a workshop for Rladies Melbourne in 2025."
  },
  {
    "objectID": "about.html#who-are-we",
    "href": "about.html#who-are-we",
    "title": "About",
    "section": "",
    "text": "https://r-ladiesmelbourne.github.io/"
  },
  {
    "objectID": "about.html#what-is-this-site",
    "href": "about.html#what-is-this-site",
    "title": "About",
    "section": "",
    "text": "This site provides a useful tutorial on how to use ggplot2, plotly, ggplotly and various visualisation forms for several use cases.\nIt provides useful links to established R manuals and helpful code.\nThe tutorial was part of a workshop for Rladies Melbourne in 2025."
  },
  {
    "objectID": "workshop.html",
    "href": "workshop.html",
    "title": "Google collab",
    "section": "",
    "text": "The tutorial is able to run the code as we walk through each step, you can edit and change the code as it suits you.\nThe ggplotly() interactive features do not work in Google Collabs. To see the difference the code will be run and the output will be compared within this presentation.\n\n\n\nNo installation needed – runs entirely in the browser.\nFree to use – provides CPU, GPU, and TPU resources at no cost.\nEasy access – just share a link; participants can start coding immediately.\nCloud storage – notebooks and files can be saved in Google Drive.\nCollaboration ready – multiple people can edit or comment, like Google Docs.\nSupports many languages – Python, R, Julia, and more with setup.\nReproducible – same environment for all participants.\nGitHub integration – open notebooks directly from repositories.\nInteractive outputs – supports plots, widgets, and even apps.\nGreat for teaching – consistent interface, easy to reset/refresh.\n\n\n\n\n\nOpen Colab\nGo to Google Colab.\nOpen the workshop notebook from GitHub\n\nClick File → Open notebook.\nSelect the GitHub tab.\nEnter:\nKirstyMcCann/2025-Sep-18_Rladies_ggplotly_workshop\nChoose the .ipynb file from the list.\n\nSave your own copy\n\nGo to File → Save a copy in Drive.\nThis makes an editable version in your Google Drive.\n\nInstall required packages Run the setup cell in the notebook (this installs R packages if needed).\nDownload workshop files (data + scripts)\nIn the first code cell, clone the repository:\nsystem(\"git clone https://github.com/KirstyMcCann/2025-Sep-18_Rladies_ggplotly_workshop.git\")\nsetwd(\"2025-Sep-18_Rladies_ggplotly_workshop\")\nRun the notebook\nUse Runtime → Run all to execute all code cells in order.\n\n\n\n\n\n\n\n\nGo to the repository webpage https://github.com/KirstyMcCann/2025-Sep-18_Rladies_ggplotly_workshop\nDownload all files as a ZIP\n\nClick the green Code button (top right).\nSelect Download ZIP.\nSave the ZIP file to your computer.\n\nUnzip the folder\n\nWindows: right-click → “Extract All…”\nMac/Linux: double-click the ZIP file.\n\nOpen the R Markdown file in RStudio\n\nOpen RStudio.\nGo to File → Open File…\nSelect the .Rmd file from the unzipped folder."
  },
  {
    "objectID": "workshop.html#google-collabs",
    "href": "workshop.html#google-collabs",
    "title": "Google collab",
    "section": "",
    "text": "The tutorial is able to run the code as we walk through each step, you can edit and change the code as it suits you.\nThe ggplotly() interactive features do not work in Google Collabs. To see the difference the code will be run and the output will be compared within this presentation.\n\n\n\nNo installation needed – runs entirely in the browser.\nFree to use – provides CPU, GPU, and TPU resources at no cost.\nEasy access – just share a link; participants can start coding immediately.\nCloud storage – notebooks and files can be saved in Google Drive.\nCollaboration ready – multiple people can edit or comment, like Google Docs.\nSupports many languages – Python, R, Julia, and more with setup.\nReproducible – same environment for all participants.\nGitHub integration – open notebooks directly from repositories.\nInteractive outputs – supports plots, widgets, and even apps.\nGreat for teaching – consistent interface, easy to reset/refresh.\n\n\n\n\n\nOpen Colab\nGo to Google Colab.\nOpen the workshop notebook from GitHub\n\nClick File → Open notebook.\nSelect the GitHub tab.\nEnter:\nKirstyMcCann/2025-Sep-18_Rladies_ggplotly_workshop\nChoose the .ipynb file from the list.\n\nSave your own copy\n\nGo to File → Save a copy in Drive.\nThis makes an editable version in your Google Drive.\n\nInstall required packages Run the setup cell in the notebook (this installs R packages if needed).\nDownload workshop files (data + scripts)\nIn the first code cell, clone the repository:\nsystem(\"git clone https://github.com/KirstyMcCann/2025-Sep-18_Rladies_ggplotly_workshop.git\")\nsetwd(\"2025-Sep-18_Rladies_ggplotly_workshop\")\nRun the notebook\nUse Runtime → Run all to execute all code cells in order."
  },
  {
    "objectID": "workshop.html#clone-the-github-repository-in-rstudio",
    "href": "workshop.html#clone-the-github-repository-in-rstudio",
    "title": "Google collab",
    "section": "",
    "text": "Go to the repository webpage https://github.com/KirstyMcCann/2025-Sep-18_Rladies_ggplotly_workshop\nDownload all files as a ZIP\n\nClick the green Code button (top right).\nSelect Download ZIP.\nSave the ZIP file to your computer.\n\nUnzip the folder\n\nWindows: right-click → “Extract All…”\nMac/Linux: double-click the ZIP file.\n\nOpen the R Markdown file in RStudio\n\nOpen RStudio.\nGo to File → Open File…\nSelect the .Rmd file from the unzipped folder."
  },
  {
    "objectID": "tutorial.html",
    "href": "tutorial.html",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "",
    "text": "This workshop introduces ggplotly, which bridges ggplot2 and plotly to create interactive graphics in R.\nYou will learn how to:\n\nStart with basic plots using ggplot2\nAdd interactivity with ggplotly\nExplore case studies (health data, COVID‑19, malaria genomics)\nSave and share interactive plots"
  },
  {
    "objectID": "tutorial.html#scatterplots",
    "href": "tutorial.html#scatterplots",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Scatterplots",
    "text": "Scatterplots\n\np1 &lt;- ggplot(df, aes(x = age, y = blood_pressure)) +\n  geom_point(alpha = 0.7) +\n  labs(title = \"Age vs Blood Pressure\")\n\nggplotly(p1)\n\n\n\n\n\n\nPurpose: Shows the relationship between two continuous variables (e.g., age vs blood pressure).\nWhy: Helps us see general patterns (e.g., older individuals may have higher blood pressure).\n\nAdd smoking:\n\np2 &lt;- ggplot(df, aes(x = age, y = blood_pressure, color = smoker)) +\n  geom_point(alpha = 0.7) +\n  labs(title = \"Blood Pressure by Age and Smoking\")\n\nggplotly(p2)"
  },
  {
    "objectID": "tutorial.html#section",
    "href": "tutorial.html#section",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "",
    "text": "Exercise\n\n\n\n\nAdd color = smoker to see if smoking status influences the age–blood pressure relationship.\nTry changing the shape by exercise_level.\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\np1_sol &lt;- ggplot(df, aes(x = age, y = blood_pressure, color = smoker, shape = exercise_level, text = paste(“Sample:”, subject_id, “Region:”, region, “Exercise:”, exercise_level))) + geom_point(alpha = 0.7) + labs(title = “Age vs Blood Pressure by Smoking & Exercise”)\nggplotly(p1_sol, tooltip = “text”)"
  },
  {
    "objectID": "tutorial.html#multivariate-plot",
    "href": "tutorial.html#multivariate-plot",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Multivariate Plot",
    "text": "Multivariate Plot\n\np3 &lt;- ggplot(df, aes(x = age, y = blood_pressure, color = smoker, shape = exercise_level, text = label)) +\n  geom_point(alpha = 0.7) +\n  labs(title = \"Interactive Scatter: Age, BP, Smoking, Exercise\")\n\nggplotly(p3, tooltip = \"text\")\n\n\n\n\n\n\nPurpose: Adds more variables (smoking status, exercise level) using color, shape, or tooltip labels.\nWhy: Real-world health outcomes are influenced by multiple factors, so we want to see how lifestyle intersects with age and blood pressure."
  },
  {
    "objectID": "tutorial.html#box-violin-plots",
    "href": "tutorial.html#box-violin-plots",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Box & Violin Plots",
    "text": "Box & Violin Plots\n\np4 &lt;- ggplot(df, aes(x = exercise_level, y = blood_pressure, fill = exercise_level)) +\n  geom_boxplot(alpha = 0.7) +\n  labs(title = \"Blood Pressure by Exercise Level\")\n\nggplotly(p4)\n\n\n\n\n\n\np_violin &lt;- ggplot(df, aes(x = smoker, y = blood_pressure, fill = smoker)) +\n  geom_violin(alpha = 0.6) +\n  geom_boxplot(width = 0.1, fill = \"white\", outlier.shape = NA) +\n  labs(title = \"Distribution of Blood Pressure by Smoking Status\")\n\nggplotly(p_violin)\n\n\n\n\n\n\nPurpose: Summarise the distribution of blood pressure across groups (e.g., smoker vs non-smoker, different exercise levels).\nWhy: Helps compare variability, medians, and outliers between groups. Violin plots additionally show the distribution shape.\n\n\n\n\n\n\n\nExercise\n\n\n\n\nChange this to a violin plot (geom_violin) to see the distribution of blood pressure within each exercise group.\nAdd jittered points with geom_jitter() to see individual values."
  },
  {
    "objectID": "tutorial.html#faceting-by-region",
    "href": "tutorial.html#faceting-by-region",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Faceting by Region",
    "text": "Faceting by Region\n\np5 &lt;- ggplot(df, aes(x = age, y = blood_pressure, color = smoker, text = label)) +\n  geom_point(alpha = 0.7) +\n  facet_wrap(~region) +\n  labs(title = \"Blood Pressure by Region\")\n\nggplotly(p5, tooltip = \"text\")\n\n\n\n\n\n\nPurpose: Splits the dataset into subplots (e.g., by region).\nWhy: Allows comparison across categories without overloading a single plot. For example, we can ask: Is the age–blood pressure relationship consistent across rural, suburban, and urban regions?"
  },
  {
    "objectID": "tutorial.html#correlation-heatmap",
    "href": "tutorial.html#correlation-heatmap",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Correlation Heatmap",
    "text": "Correlation Heatmap\n\ncorr_data &lt;- df %&gt;% select(age, blood_pressure, bmi, cholesterol)\ncorr_mat &lt;- round(cor(corr_data, use = \"pairwise.complete.obs\"), 2)\nmelted &lt;- melt(corr_mat)\n\np_corr &lt;- ggplot(melted, aes(Var1, Var2, fill = value)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = value)) +\n  scale_fill_gradient2(low = \"blue\", mid = \"white\", high = \"red\", midpoint = 0) +\n  labs(title = \"Correlation Heatmap\")\n\nggplotly(p_corr)\n\n\n\n\n\n\nPurpose: Display pairwise correlations between multiple numeric health indicators (age, blood pressure, BMI, cholesterol).\nWhy: Provides a quick overview of which factors are most strongly related."
  },
  {
    "objectID": "tutorial.html#summary-of-findings-case-study-1",
    "href": "tutorial.html#summary-of-findings-case-study-1",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Summary of Findings (Case Study 1)",
    "text": "Summary of Findings (Case Study 1)\n\nBlood pressure tends to increase with age.\nSmokers may have higher blood pressure compared to non-smokers.\nExercise level appears to influence blood pressure distribution (lower in higher exercise groups).\nCorrelation analysis highlights potential links between health indicators (e.g., BMI and blood pressure).\nRegional differences emerge when using facets, suggesting environment also matters."
  },
  {
    "objectID": "tutorial.html#why-use-ggplotly-for-interactivity",
    "href": "tutorial.html#why-use-ggplotly-for-interactivity",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Why Use ggplotly for Interactivity?",
    "text": "Why Use ggplotly for Interactivity?\nEnhanced Exploration\n\nHovering shows exact values (age, BP, lifestyle factors).\nTool tips allow inclusion of metadata (subject ID, labels).\n\nData Filtering\n\nLegends are clickable — users can hide/show smokers, exercise levels, or regions.\n\nZoom & Pan\n\nUsers can focus on sub-ranges (e.g., ages 20–40 or BP &gt; 160).\n\nCommunication\n\nInteractive plots are more engaging for teaching, reporting, or sharing with non-technical audiences."
  },
  {
    "objectID": "tutorial.html#advantages-of-these-analyses",
    "href": "tutorial.html#advantages-of-these-analyses",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Advantages of these Analyses",
    "text": "Advantages of these Analyses\n\nCapture both overall patterns and group-specific differences.\nCombine exploratory (scatter, violin) and summary (boxplot, heatmap) approaches.\nFacilitate hypothesis generation — e.g., does exercise buffer age-related blood pressure increases?\n\n\n\n\n\n\n\nReflection\n\n\n\n\nWhich lifestyle factor (smoking, exercise, BMI, cholesterol) showed the strongest relationship with blood pressure?\nDid faceting by region or age group reveal any new patterns?\nWrite down 2–3 sentences summarising your findings."
  },
  {
    "objectID": "tutorial.html#geographic-spread",
    "href": "tutorial.html#geographic-spread",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Geographic Spread",
    "text": "Geographic Spread\n\nstrain_summary &lt;- df %&gt;%\n  group_by(country, strain) %&gt;%\n  summarise(count = n(), latitude = mean(latitude), longitude = mean(longitude), .groups = \"drop\")\n\nplot_geo(strain_summary) %&gt;%\n  add_markers(x = ~longitude, y = ~latitude, size = ~count, color = ~strain,\n              text = ~paste(\"Country:\", country, \"&lt;br&gt;Strain:\", strain, \"&lt;br&gt;Count:\", count),\n              hoverinfo = \"text\") %&gt;%\n  layout(title = \"COVID‑19 Strain Frequency by Country\",\n         geo = list(scope = \"world\", projection = list(type = \"natural earth\")))\n\n\n\n\n\n\nPurpose: Visualise where strains occur and how frequently in each country.\nWhy: Shows global spread and geographic hotspots of different strains.\n\n\n\n\n\n\n\nExercise\n\n\n\n\nChange scope = \"world\" to \"asia\" or \"europe\" to zoom in on specific regions.\nTry coloring by country instead of strain."
  },
  {
    "objectID": "tutorial.html#time-trends",
    "href": "tutorial.html#time-trends",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Time Trends",
    "text": "Time Trends\n\ndf &lt;- df %&gt;% mutate(month = floor_date(as.Date(collection_date), \"month\"))\n\nstrain_trend &lt;- df %&gt;% group_by(month, strain) %&gt;% summarise(count = n(), .groups = \"drop\")\n\ntimeline &lt;- ggplot(strain_trend, aes(x = month, y = count, color = strain)) +\n  geom_line(size = 1) +\n  labs(title = \"Strain Evolution Over Time\")\n\nggplotly(timeline)\n\n\n\n\n\n\nPurpose: Track strain counts over time.\nWhy: Lets us see how specific variants emerge, rise, and decline.\n\n\n\n\n\n\n\nExercise\n\n\n\n\nChange the x-axis to year only (aggregate with lubridate::year()).\nAdd facet_wrap(~country) to compare strain dynamics between countries.\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nstrain_trend_year &lt;- df %&gt;%\nmutate(year = lubridate::year(month)) %&gt;%\ngroup_by(year, strain, country) %&gt;%\nsummarise(count = n(), .groups = “drop”)\ntimeline_sol &lt;- ggplot(strain_trend_year, aes(x = year, y = count, color = strain)) +\ngeom_line(size = 1) +\nfacet_wrap(~country) +\nlabs(title = “Strain Evolution Over Years by Country”)\nggplotly(timeline_sol)"
  },
  {
    "objectID": "tutorial.html#relative-proportions",
    "href": "tutorial.html#relative-proportions",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Relative Proportions",
    "text": "Relative Proportions\n\nstrain_trend_prop &lt;- df %&gt;%\n  group_by(month) %&gt;% mutate(total = n()) %&gt;%\n  group_by(month, strain) %&gt;% summarise(prop = n()/unique(total), .groups=\"drop\")\n\np_area &lt;- ggplot(strain_trend_prop, aes(x = month, y = prop, fill = strain)) +\n  geom_area(alpha = 0.8) +\n  scale_y_continuous(labels = scales::percent) +\n  labs(title = \"Relative Frequency of Strains Over Time\")\n\nggplotly(p_area)\n\n\n\n\n\n\nPurpose: Show the proportion of each strain at different time points.\nWhy: Easier to see when one strain becomes dominant over others, even if total case numbers vary."
  },
  {
    "objectID": "tutorial.html#phylogenetic-tree",
    "href": "tutorial.html#phylogenetic-tree",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Phylogenetic Tree",
    "text": "Phylogenetic Tree\n\nmut_matrix &lt;- dist(df$mutations)\ntree &lt;- nj(mut_matrix)\ntree$tip.label &lt;- df$sample_id\n\nstrain_colors &lt;- scales::hue_pal()(length(unique(df$strain)))\n\nggtree(tree, layout = \"circular\", aes(color = strain)) %&lt;+% df +\n  geom_tree(color = \"gray70\") +\n  geom_tippoint(size = 2) +\n  scale_color_manual(values = strain_colors)\n\n\n\n\n\n\n\n\n\nPurpose: Display genetic relationships between samples.\nWhy: Reveals how strains are related, showing clusters, divergence, and evolutionary history."
  },
  {
    "objectID": "tutorial.html#summary-of-findings-case-study-2",
    "href": "tutorial.html#summary-of-findings-case-study-2",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Summary of Findings (Case Study 2)",
    "text": "Summary of Findings (Case Study 2)\n\nDifferent strains are distributed unevenly across the globe.\nSome strains rise quickly over time while others decline.\nDominance shifts are clear when looking at relative proportions (e.g., one variant replaces another).\nPhylogenetic analysis confirms these dynamics, showing how strains diverge from common ancestors."
  },
  {
    "objectID": "tutorial.html#why-use-ggplotly-for-interactivity-1",
    "href": "tutorial.html#why-use-ggplotly-for-interactivity-1",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Why Use ggplotly for Interactivity?",
    "text": "Why Use ggplotly for Interactivity?\n\nMaps: Hover to see country, strain, and sample count; zoom to specific regions.\nTimelines: Hover reveals exact counts per strain per month.\nStacked Areas: Clicking legend items lets you isolate or compare particular strains.\nTrees: Tool tips can add sample IDs, making phylogenetics more interpretable."
  },
  {
    "objectID": "tutorial.html#advantages-of-these-analyses-1",
    "href": "tutorial.html#advantages-of-these-analyses-1",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Advantages of These Analyses",
    "text": "Advantages of These Analyses\n\nIntegrates epidemiology (spread in space and time) with genomics (strain evolution).\nMakes it easier to communicate both patterns (e.g., global dominance of one strain) and details (e.g., a country-specific outbreak).\nInteractivity allows policymakers, scientists, and the public to explore the data themselves.\nHelps answer complex questions: Where did new strains appear first? How quickly did they spread? How are they genetically related?\n\n\n\n\n\n\n\nReflection\n\n\n\n\nWhich strains spread most rapidly across regions?\nDid the timeline show any waves of infection linked to specific variants?\nSummarise the key insight from the interactive plots in 2–3 sentences."
  },
  {
    "objectID": "tutorial.html#pcadapc",
    "href": "tutorial.html#pcadapc",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "PCA/DAPC",
    "text": "PCA/DAPC\n\np1 &lt;- ggplot(malaria, aes(x=PC1, y=PC2, color=resistance,\n                          text=paste(\"Sample:\", sample_id,\n                                     \"&lt;br&gt;Region:\", region,\n                                     \"&lt;br&gt;Year:\", year))) +\n  geom_point(size=3, alpha=0.7) +\n  labs(title=\"Population Structure of Malaria Parasites\",\n       x=\"PC1\", y=\"PC2\")\n\nggplotly(p1, tooltip=\"text\")\n\n\n\n\n\n\nPurpose: Show overall genetic structure of parasite populations.\nWhy: Helps detect clustering of resistant vs. sensitive parasites and highlights whether resistance is spreading within or across regions.\nInteractivity adds hover labels (sample, region, year) so you can connect points to metadata.\n\n\n\n\n\n\n\nExercise\n\n\n\n\nRecolor this PCA by region instead of resistance.\nAdd facet_wrap(~year) to compare across years."
  },
  {
    "objectID": "tutorial.html#distribution-of-fst",
    "href": "tutorial.html#distribution-of-fst",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Distribution of FST",
    "text": "Distribution of FST\n\np_fst &lt;- ggplot(genome_data, aes(x = fst)) +\n  geom_histogram(bins = 30, fill = \"steelblue\", alpha = 0.7) +\n  labs(title = \"Distribution of FST Across Genes\")\n\nggplotly(p_fst)\n\n\n\n\n\n\nPurpose: Quantify genetic differences between parasite populations (e.g., across regions or years).\nWhy: Helps identify regions of the genome under selection or where populations are diverging."
  },
  {
    "objectID": "tutorial.html#manhattan-plot",
    "href": "tutorial.html#manhattan-plot",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Manhattan Plot",
    "text": "Manhattan Plot\n\np_manhattan &lt;- ggplot(genome_data, aes(x = start, y = fst, color = species, text = gene_id)) +\n  geom_point(alpha = 0.6) +\n  facet_wrap(~chr, scales = \"free_x\") +\n  labs(title = \"FST Across Chromosomes\")\n\nggplotly(p_manhattan, tooltip = \"text\")"
  },
  {
    "objectID": "tutorial.html#gwas",
    "href": "tutorial.html#gwas",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "GWAS",
    "text": "GWAS\n\np2 &lt;- ggplot(malaria, aes(x=snp_pos, y=-log10(pval),\n                          color=factor(snp_chr),\n                          text=paste(\"Chr:\", snp_chr,\n                                     \"&lt;br&gt;Pos:\", snp_pos,\n                                     \"&lt;br&gt;P:\", signif(pval,3)))) +\n  geom_point(alpha=0.7) +\n  labs(title=\"GWAS Manhattan Plot for Drug Resistance\",\n       x=\"Genomic Position\", y=\"-log10(p-value)\") +\n  theme_minimal()\n\nggplotly(p2, tooltip=\"text\")\n\n\n\n\n\n\nPurpose: Identify SNPs associated with drug resistance.\nWhy: Allows quick spotting of genomic “peaks” (e.g., on chromosome 7) that may correspond to known drug resistance genes (pfcrt, pfmdr1).\nInteractivity lets you zoom in, filter chromosomes, and hover to see SNP details.\n\n\n\n\n\n\n\nExercise\n\n\n\n\nZoom into chromosome 7 to see the strong association peak.\nAdd facet_wrap(~region) to compare signals between regions.\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\np2_sol &lt;- ggplot(malaria %&gt;% filter(snp_chr == 7), aes(x = snp_pos, y = -log10(pval), color = region, text = paste(“SNP:”, snp_chr, “Pos:”, snp_pos, “P:”, signif(pval, 3)))) + geom_point(alpha = 0.7) + labs(title = “GWAS Results: Chromosome 7, by Region”)\nggplotly(p2_sol, tooltip = “text”)"
  },
  {
    "objectID": "tutorial.html#drug-resistance-prediction-plot",
    "href": "tutorial.html#drug-resistance-prediction-plot",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Drug resistance Prediction Plot",
    "text": "Drug resistance Prediction Plot\n\np3 &lt;- ggplot(malaria, aes(x=freq, y=resistant_binary,\n                          color=resistance,\n                          text=paste(\"Sample:\", sample_id,\n                                     \"&lt;br&gt;Allele Freq:\", round(freq,2),\n                                     \"&lt;br&gt;Status:\", resistance))) +\n  geom_jitter(height=0.05, alpha=0.7) +\n  geom_smooth(method=\"glm\", method.args=list(family=\"binomial\"),\n              se=FALSE, color=\"black\") +\n  labs(title=\"Predicted Probability of Resistance\",\n       x=\"Allele Frequency\", y=\"Resistance (0/1)\")\n\nggplotly(p3, tooltip=\"text\")\n\n\n\n\n\n\nPurpose: Visualize the probability of resistance given allele frequency.\nWhy: Shows how certain mutations strongly predict drug resistance status.\nInteractivity lets you hover over points to see which individuals drive the relationship.\n\n\n\n\n\n\n\nExercise\n\n\n\n\nAdd hover text to show sample_id."
  },
  {
    "objectID": "tutorial.html#drug-resistance-spread-over-time",
    "href": "tutorial.html#drug-resistance-spread-over-time",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Drug resistance Spread over time",
    "text": "Drug resistance Spread over time\n\nres_trend &lt;- malaria %&gt;%\n  group_by(year, region) %&gt;%\n  summarise(resistant_rate = mean(resistant_binary),\n            n=n(), .groups=\"drop\")\n\np4 &lt;- ggplot(res_trend, aes(x=year, y=resistant_rate,\n                            color=region,\n                            text=paste(\"Region:\", region,\n                                       \"&lt;br&gt;Year:\", year,\n                                       \"&lt;br&gt;Resistant Rate:\", round(resistant_rate,2),\n                                       \"&lt;br&gt;n:\", n))) +\n  geom_line(size=1) +\n  geom_point(size=2) +\n  labs(title=\"Spread of Resistance Over Time\",\n       x=\"Year\", y=\"Resistance Frequency\") +\n  theme_minimal()\n\nggplotly(p4, tooltip=\"text\")\n\n\n\n\n\n\nPurpose: Track how resistance frequency changes across regions and years.\nWhy: Reveals whether resistance is spreading in particular areas (e.g., rapid increase in SE Asia after 2015).\nInteractivity makes it easy to hover for exact rates, zoom into certain years, and compare regions.\n\n\n\n\n\n\n\nExercise\n\n\n\n\nRestrict the time window to year &gt;= 2010.\nTry faceting by region for clearer comparison.\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nres_trend_recent &lt;- malaria %&gt;% filter(year &gt;= 2010) %&gt;% group_by(year, region) %&gt;% summarise(resistant_rate = mean(resistant_binary), n = n(), .groups = “drop”)\n\nFaceted plot by region\np4_sol &lt;- ggplot(res_trend_recent, aes(x = year, y = resistant_rate, color = region, text = paste(“Region:”, region, “Year:”, year, “Resistant Rate:”, round(resistant_rate, 2), “n:”, n))) + geom_line(size = 1) + geom_point(size = 2) + facet_wrap(~region) + labs(title = “Spread of Resistance Over Time (since 2010)”, x = “Year”, y = “Resistance Frequency”) + theme_minimal()\nggplotly(p4_sol, tooltip = “text”)\np2_sol &lt;- ggplot(malaria %&gt;% filter(snp_chr == 7), aes(x = snp_pos, y = -log10(pval), color = region, text = paste(“SNP:”, snp_chr, “Pos:”, snp_pos, “P:”, signif(pval, 3)))) + geom_point(alpha = 0.7) + labs(title = “GWAS Results: Chromosome 7, by Region”)\nggplotly(p2_sol, tooltip = “text”)"
  },
  {
    "objectID": "tutorial.html#ibd-network-connectivity",
    "href": "tutorial.html#ibd-network-connectivity",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "IBD Network Connectivity",
    "text": "IBD Network Connectivity\n\nWhy: Explore who is connected to whom via identical-by-descent (IBD) sharing, a direct marker of transmission.\nAnimated across timepoints to visualize transmission spread.\nInteractivity lets learners hover on nodes/edges to see sample IDs, regions, and IBD values.\n\n\n\n\n\n\n\nTip\n\n\n\nTry to first filter the data for one year and plot the network.\nThen, extend it into an animation to see how connectivity evolves.\n\n\n\n# Load data\nsamples &lt;- read_csv(\"data/malaria_samples_updated.csv\")\nedges   &lt;- read_csv(\"data/malaria_ibd_edges_updated.csv\")\n\n\n# Build global network\ng &lt;- graph_from_data_frame(d = edges, vertices = samples, directed = FALSE)\n\n# Animated IBD network using gganimate\np_anim &lt;- ggraph(g, layout = \"fr\") +\n  geom_edge_link(aes(width = ibd, alpha = ibd), color = \"darkred\") +\n  geom_node_point(aes(color = country,\n                      text = paste(\"Sample:\", name,\n                                   \"&lt;br&gt;Region:\", country,\n                                   \"&lt;br&gt;Year:\", year))) +\n  theme_void() +\n  scale_edge_width(range = c(0.3, 2)) +\n  labs(title = \"IBD Network Over Time\", subtitle = \"Year: {closest_state}\") +\n  transition_states(year, transition_length = 2, state_length = 1) +\n  ease_aes(\"cubic-in-out\")\n\nanimate(p_anim, nframes = 40, fps = 4, width = 800, height = 600)\n\n\n# Example: interactive network for one year (2013)\ng_year &lt;- graph_from_data_frame(\n  d = edges %&gt;% filter(year == 2013),\n  vertices = samples,\n  directed = FALSE\n)\n\n# Layout coordinates\ncoords &lt;- layout_with_fr(g_year)\ncoords_df &lt;- data.frame(coords)\nnames(coords_df) &lt;- c(\"x\", \"y\")\ncoords_df$sample_id &lt;- V(g_year)$name\ncoords_df$country &lt;- V(g_year)$country\ncoords_df$year &lt;- V(g_year)$year\n\n# Edge data\nedge_df &lt;- data.frame(get.edgelist(g_year))\nnames(edge_df) &lt;- c(\"from\", \"to\")\nedge_df &lt;- edge_df %&gt;%\n  left_join(coords_df, by = c(\"from\" = \"sample_id\")) %&gt;%\n  rename(x_from = x, y_from = y,\n         region_from = country, year_from = year) %&gt;%\n  left_join(coords_df, by = c(\"to\" = \"sample_id\")) %&gt;%\n  rename(x_to = x, y_to = y,\n         region_to = country, year_to = year)\n\n# Interactive plotly network\nplot_ly(type = \"scatter\", mode = \"lines\") %&gt;%\n  add_segments(\n    data = edge_df,\n    x = ~x_from, y = ~y_from,\n    xend = ~x_to, yend = ~y_to,\n    line = list(color = \"red\", width = 1),\n    hoverinfo = \"none\"\n  ) %&gt;%\n  add_markers(\n    data = coords_df,\n    x = ~x, y = ~y,\n    color = ~country,\n    text = ~paste(\"Sample:\", sample_id,\n                  \"&lt;br&gt;Region:\", country,\n                  \"&lt;br&gt;Year:\", year),\n    hoverinfo = \"text\",\n    marker = list(size = 10)\n  ) %&gt;%\n  layout(\n    title = \"IBD Network Connectivity (2013)\",\n    xaxis = list(title = NULL, showgrid = FALSE,\n                 zeroline = FALSE, showticklabels = FALSE),\n    yaxis = list(title = NULL, showgrid = FALSE,\n                 zeroline = FALSE, showticklabels = FALSE)\n  )"
  },
  {
    "objectID": "tutorial.html#summary-of-findings-case-study-3",
    "href": "tutorial.html#summary-of-findings-case-study-3",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Summary of Findings (Case Study 3)",
    "text": "Summary of Findings (Case Study 3)\n\nPopulation structure (PCA): Resistant parasites cluster more strongly in SE Asia, suggesting a regional origin of resistance.\nFST highlights loci where populations are genetically diverging — potentially due to selection (e.g., drug resistance).\nGWAS Manhattan plot: Strong association signals on chromosome 7, consistent with known drug resistance genes.\nPrediction plot: Resistance probability increases sharply with allele frequency at key SNPs.\nDynamics plot: Resistance frequency is rising over time, especially in SE Asia post-2015, with slower spread elsewhere.\nIBD networks: revealed direct transmission links and how they evolve year-to-year."
  },
  {
    "objectID": "tutorial.html#why-use-ggplotly-for-interactivity-2",
    "href": "tutorial.html#why-use-ggplotly-for-interactivity-2",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Why Use ggplotly for Interactivity?",
    "text": "Why Use ggplotly for Interactivity?\n\nHovering makes it easy to link individuals (in PCA) or SNPs (in GWAS) to metadata.\nFST Plots: Zoom in to regions of high differentiation for closer inspection.\nZooming in helps focus on specific genomic regions or time windows.\nLegends let you toggle regions, resistance status, or chromosomes on and off.\nFor teaching and exploration, interactivity makes complex genomics data more approachable.\nHovering lets you read exact SNPs, probabilities, samples, or IBD weights.\nNetworks become explorable: zoom into highly connected clusters.\nFacilitates teaching population genomics interactively."
  },
  {
    "objectID": "tutorial.html#advantages-of-these-analyses-2",
    "href": "tutorial.html#advantages-of-these-analyses-2",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "Advantages of These Analyses",
    "text": "Advantages of These Analyses\n\nCombines population genetics, evolutionary biology, and visualisation in one workflow.\nHelps researchers detect signals of drug resistance, adaptation, and epidemiological shifts.\nInteractivity lowers barriers for exploring high-dimensional genomic data.\nUseful for both hypothesis generation (which genes might be under selection?) and communication (showing resistance hotspots to policymakers).\nDetects drug resistance origins and spread across time and geography.\nLinks genotype to phenotype in an intuitive, visual way.\nInteractivity empowers both scientists and policymakers to explore the data dynamically.\n\n\n\n\n\n\n\nReflection\n\n\n\n\nWhere did drug resistance appear to spread first?\nWhich SNPs were most strongly associated with resistance?\nSummarise the population genomic findings in 2–3 sentences."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Plot Twist: Bringing Your ggplot2 Visuals to Life with ggplotly",
    "section": "",
    "text": "What is ggplotly?\nThe ggplotly() function within Plotly can convert your ggplot2 figures into interactive figures powered by plotly. js, ready for embedding into Dash applications. ggplotly is free and open source and you can view the source, report issues or contribute on GitHub.\nGreat for presentations!\n\n\nUseful links\nR-Graph-Gallery: https://r-graph-gallery.com/index.html\nplotly: https://plotly.com/r/\nggplot2: https://ggplot2.tidyverse.org/\nR for Data Science: https://r4ds.had.co.nz/data-visualisation.html\nR statistics: https://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html\ngganimate: https://gganimate.com/\nhtmlwidgets: https://www.htmlwidgets.org/\nggtree: https://yulab-smu.top/treedata-book/\n\nColours\nRColorBrewer: https://r-graph-gallery.com/38-rcolorbrewers-palettes.html\npaletteer: https://pmassicotte.github.io/paletteer_gallery/\nviridis: https://sjmgarnier.github.io/viridis/"
  }
]